<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solicitud</title>
    <link rel="stylesheet" type="text/css" href="ISI.css">
    <script>
        function actualizarTabla() {
            var gasto = document.getElementById("Gasto").value;
            var tabla = document.getElementById("tablaGastos");

            if (gasto === "Administrativo") {
                tabla.innerHTML = `
                <div style="display: flex; gap: 20px; justify-content: center;">
                    <table border="1"> 
                        <tr>
                            <td>Solicita</td>
                            <td><input type="text" name="Solicita" placeholder="¿Quién lo solicita?"/></td>
                            <td>No. Gasto</td>
                            <td><input type="text" name="Gasto" placeholder="Coloca No. Gasto..."/></td>
                            <td>Fecha</td>
                            <td><input type="date" name="Fecha" /></td>
                        </tr>


                    </table>

                    <table border="1"> 
                        <tr>
                            <td>Pre cotización</td>
                            <td><input type="checkbox" id="pre-cotizacion" name="pre cotización"></td>
                            <td>Cotización</td>
                            <td><input type="checkbox" name="Cotización"></td>
                        </tr>
                    </table>

                    <table border="1"> 
                        <tr>
                            <td>Empresa</td>
                            <td>
                                <div style="display: flex; align-items: center;">
                                    <select id="empresa_options" name="empresa_options" class="dropdown">
                                        <option value="null">Selecciona empresa</option>
                                        <option value="Cafetal">Cafetal</option>
                                        <option value="Edificaciones">Edificaciones</option>
                                        <option value="Fresh & Limp">Fresh & Limp</option>
                                        <option value="Ofic. 1104">Ofic. 1104</option>
                                        <option value="Ofic. 1403">Ofic. 1403</option>
                                        <option value="UR">UR</option>
                                        <option value="Personal">Personal</option>
                                        <option value="Servicio">Servicio</option>
                                        <option value="Otros">Otros</option>                                                                                                                                                                                         
                                    </select>
                                </div>
                            </td>
                            <td>Zona</td>
                            <td>
                                <div style="display: flex; align-items: center;">
                                    <select id="zona_options" name="zona_options" class="dropdown">
                                        <option value="null">Selecciona una zona</option>
                                        <option value="GDL">GDL</option>
                                        <option value="PUE">PUE</option>
                                    </select>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Compra solicitada</td>
                            <td colspan="7"><input type="text" name="Compra" placeholder="Me gustaría solicitar...." style="width: 100%;"/></td>
                        </tr>
                        <tr>
                            <td>Coordinador</td>
                            <td><input type="text" name="Responsable" placeholder="Responsable" /></td>
                            <td>Anticipo</td>
                            <td><input type="number" name="Anticipo" placeholder="Monto de anticipo..."/></td> 
                        </tr>
                    </table>
                </div>
                `;
            } else if (gasto === "Servicio") {
                tabla.innerHTML = `
                <div style="display: flex; gap: 20px; justify-content: center;">
                    <table border="1"> 
                        <tr>
                            <td>Folio</td>
                            <td><input type="text" name="Folio" placeholder="No. Folio"/></td>
                            <td>Pre cotización</td>
                            <td><input type="checkbox" id="pre-cotizacion" name="pre cotización"></td>
                            <td>Cotización</td>
                            <td><input type="checkbox" name="Cotización"/></td>

                
                        </tr>
                    </table>
                                <table border="1"> 
                            <tr>
                                <th></th>
                                <th>Planta</th> 
                                <th>Revolvedora</th>
                            </tr>
                            <tr>
                                <td>Servicio</td>
                                <td><input type="text" name="input1_row1" /></td> 
                                <td><input type="text" name="input2_row1" /></td>
                            </tr>
                            <tr>
                                <td>Mov/Trasl</td>
                                <td><input type="text" name="input1_row2" /></td>
                                <td><input type="text" name="input2_row2" /></td>
                            </tr>
                        </table>

                    <table border="1"> 
                        <tr>
                            <td>Empresa</td>
                            <td>
                                <div style="display: flex; align-items: center;">
                                    <select id="empresa_options" name="empresa_options" class="dropdown">
                                        <option value="null">Selecciona empresa</option>
                                        <option value="ISI">ISI</option>
                                        <option value="MIC">MIC</option>
                                        <option value="CSM">CSM</option>
                                    </select>
                                </div>
                            </td>
                            <td>Zona</td>
                            <td>
                                <div style="display: flex; align-items: center;">
                                    <select id="zona_options" name="zona_options" class="dropdown">
                                        <option value="null">Selecciona una zona</option>
                                        <option value="GDL">GDL</option>
                                        <option value="MEX">MEX</option>
                                        <option value="PUE">PUE</option>
                                        <option value="QRO">QRO</option>
                                        <option value="VER">VER</option>
                                    </select>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Atiende</td>
                            <td colspan="7"><input type="text" name="Comentarios" placeholder="Comentarios" style="width: 100%;"/></td>
                        </tr>
                        <tr>
                            <td>Cliente</td>
                            <td><input type="text"/></td>
                            <td>No. Cliente</td>
                            <td><input type="text"/></td>

                        </tr>
                        <tr>
                            <td>Solicita</td>
                            <td><input type="text"/></td>
                            <td>Monto que solicita</td>
                            <td><input type="text"/></td>

                        </tr>
                        <tr>
                            <td>Falla reportada</td>
                            <td colspan="7"><input type="text" name="Falla reportada" placeholder="Describe la falla..." style="width: 100%;"/></td>
                        </tr>
                    </table>
                </div>
                `;
            } else {
                tabla.innerHTML = "";
            }
        }

        function enviarFormulario() {
            const scriptURL = 'https://docs.google.com/spreadsheets/d/1mEbuxY2PBeOh8HHpFGOm_49xM_kqzPhY28QrgKY2u6A/edit?usp=sharing';  // Reemplaza YOUR_SCRIPT_ID con tu ID de script
            const form = document.forms['google-sheet'];

            form.addEventListener('submit', e => {
                e.preventDefault();
                fetch(scriptURL, { method: 'POST', body: new FormData(form) })
                    .then(response => alert('Formulario enviado exitosamente'))
                    .catch(error => console.error('Error!', error.message))
            });
        }
    </script>
</head>
<body>
    <nav class="navbar">
        <div class="hamburger-menu">
            <div class="line"></div>
            <div class="line"></div>
            <div class="line"></div> 
        </div>
        <ul class="nav-links"> 
           <li><a href="#">Solicitud</a></li>
           <li><a href="#">Folio de trabajo</a></li> 
           <li><a href="#">No. Folio</a></li> 
           <li><a href="#">No. de Gasto</a></li>
           <li><a href="#">Costo</a></li> 
           <li><a href="#">Hoja de validación</a></li>
           <li><a href="#">Cotización</a></li>
       </ul>
    </nav>

    <div class="container">
        <div class="header">
            <h3>Solicitud</h3>
            <div class="logo-container">
                <img src="C:\Users\octav\OneDrive\Documentos\Programas\HTML & CSS\ISI_OP2\Logos\Logo ISI simple.png" alt="Logo ISI simple">
                <img src="C:\Users\octav\OneDrive\Documentos\Programas\HTML & CSS\ISI_OP2\Logos\logo mic.jpg" alt="Logo mic">
                <img src="C:\Users\octav\OneDrive\Documentos\Programas\HTML & CSS\ISI_OP2\Logos\Logo CSM sello.png" alt="Logo CSM Sello">
            </div>
        </div>
        <p></p>
        <form name="google-sheet" autocomplete="off" method="post">
            <div class="input-list">
                <div class="input-container">
                    <select id="Gasto" name="gasto_options" class="dropdown" onchange="actualizarTabla()">
                        <option value="null">Selecciona el tipo de gasto...</option>
                        <option value="Administrativo">Administrativo</option>
                        <option value="Servicio">Servicios</option>
                    </select>
                </div>
            </div>
            <p></p>
            <table id="tablaGastos"></table>
            <button type="submit" onclick="enviarFormulario()">Enviar</button>
        </form>
    </div>
</body>
</html>

